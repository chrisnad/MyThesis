D=[40 80 160]';
a=[0 0.2 0.5]';

sigma=[7.623625 2.489 1.9473 ; 6.102667 2.83667 1.2539 ;5.9329 2.5003 0.96689];

%plot(D,sigma,'*');
%x = zeros(1,180);
z = zeros(180,180);
%t = 21:200;
Gf=80;
cf=0.0277;
r=0.5;
k=115;
lp=0.00205;

for i=1:180
    for j=1:180
        x=j/360;
        d=i/1000;
        
        E=40311000000;
        
        f=1.9-x*(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3);
        ff=f*sqrt(x)/(1+2*x)/(1-x)^(1.5);
        
        g=ff^2;
        
        gp=1/((1-x)^3*(1+2*x)^2)*2*x^1*(0.089-0.603*(1-x)+0.441*(1-x)^2-1.223*(1-x)^3-(-0.603+0.882*(1-x)-3.669*(1-x)^2)*x)*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)-(4*x^1*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)^2)/((1-x)^3*(1+2*x)^3)+(1*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)^2)/((1-x)^3*(1+2*x)^2)+(3*x^1*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)^2)/((1-x)^4*(1+2*x)^2);
       
        gpp=(2*x^1*(0.089-0.603*(1-x)+0.441*(1-x)^2-1.223*(1-x)^3-(-0.603+0.882*(1-x)-3.669*(1-x)^2)*x)^2)/((1-x)^3*(1+2*x)^2)+1/((1-x)^3*(1+2*x)^2)*2*x^1*(1.206-1.764*(1-x)+7.338*(1-x)^2-(-0.882+7.338*(1-x))*x)*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)-1/((1-x)^3*(1+2*x)^3)*16*x^1*(0.089-0.603*(1-x)+0.441*(1-x)^2-1.223*(1-x)^3-(-0.603+0.882*(1-x)-3.669*(1-x)^2)*x)*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)+1/((1-x)^3*(1+2*x)^2)*4*(0.089-0.603*(1-x)+0.441*(1-x)^2-1.223*(1-x)^3-(-0.603+0.882*(1-x)-3.669*(1-x)^2)*x)*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)+1/((1-x)^4*(1+2*x)^2)*12*x^1*(0.089-0.603*(1-x)+0.441*(1-x)^2-1.223*(1-x)^3-(-0.603+0.882*(1-x)-3.669*(1-x)^2)*x)*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)+(24*x^1*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)^2)/((1-x)^3*(1+2*x)^4)-(8*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)^2)/((1-x)^3*(1+2*x)^3)-(24*x^1*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)^2)/((1-x)^4*(1+2*x)^3)+(6*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)^2)/((1-x)^4*(1+2*x)^2)+(12*x^1*(1.9-(-0.089+0.603*(1-x)-0.441*(1-x)^2+1.223*(1-x)^3)*x)^2)/((1-x)^5*(1+2*x)^2);
        
        z(i,j) = sqrt(E*Gf/(gp*cf+g*d))*(1-r*cf^2*gpp*exp(-k*x^2)/4/(lp+d)*(g*d+gp*cf))^(1/r)/1000000;
        
    end
end

%x = Points(:,1);
%y = Points(:,2);
%z = Points(:,3);
x = [0.00277777777777777777777 : 0.00277777777777777777777 : 0.5]';
y = [1 : 180]';



surf(x,y,z)

% or simply:
hold on
%surf(Points(:,1),Points(:,2),Points(:,3))
%surf(a,D,sigma);
%surf(a,D,sigma,'*')
%hold all
%plot(t,y);
%grid on
%hold off